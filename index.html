<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AniResizer Pro - Advanced AI-Powered Image Processing Studio</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
  <style>
    /* --- GLOBAL VARIABLES --- */
    :root {
      --primary-dark: #0a0a0b;
      --secondary-dark: #1a1a1c;
      --primary-green: #00ff88;
      --accent-green: #00cc6a;
      --highlight-green: #39ff9a;
      --light-gray: #f8fafc;
      --mid-gray: #94a3b8;
      --dark-gray: #475569;
      --panel-bg: rgba(26, 26, 28, 0.95);
      --panel-border: rgba(0, 255, 136, 0.2);
      --glow: 0 0 20px rgba(0, 255, 136, 0.4);
      --glow-strong: 0 0 40px rgba(0, 255, 136, 0.6);
      --gradient-primary: linear-gradient(135deg, var(--primary-green), var(--accent-green));
      --gradient-bg: radial-gradient(circle at 20% 50%, rgba(0, 255, 136, 0.1) 0%, transparent 50%),
                     radial-gradient(circle at 80% 20%, rgba(0, 204, 106, 0.1) 0%, transparent 50%),
                     linear-gradient(135deg, var(--primary-dark), var(--secondary-dark));
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: var(--gradient-bg);
      color: var(--light-gray);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.6;
      position: relative;
    }

    /* Animated background particles */
    .bg-particles {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--primary-green);
      border-radius: 50%;
      animation: float 8s infinite ease-in-out;
      opacity: 0.3;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0; }
      10%, 90% { opacity: 0.3; }
      50% { transform: translateY(-100px) rotate(180deg); opacity: 0.6; }
    }

    /* Header with enhanced design */
    .header {
      position: sticky;
      top: 0;
      background: rgba(10, 10, 11, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--panel-border);
      z-index: 100;
      padding: 20px;
    }

    .nav-container {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .logo-icon {
      font-size: 2.5rem;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .logo-text h1 {
      font-size: 2rem;
      font-weight: 800;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 2px;
    }

    .pro-badge {
      background: var(--gradient-primary);
      color: var(--primary-dark);
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 0.5px;
    }

    .nav-links {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    .nav-link {
      color: var(--mid-gray);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
      position: relative;
    }

    .nav-link:hover {
      color: var(--primary-green);
    }

    .nav-link::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -5px;
      left: 50%;
      background: var(--gradient-primary);
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }

    .nav-link:hover::after {
      width: 100%;
    }

    /* Main container */
    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    /* Enhanced panels */
    .workspace {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 30px;
      margin-bottom: 40px;
    }

    @media (max-width: 1200px) {
      .workspace {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: var(--panel-bg);
      border-radius: 20px;
      padding: 30px;
      border: 1px solid var(--panel-border);
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      backdrop-filter: blur(20px);
      position: relative;
      overflow: hidden;
    }

    .panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 1px;
      background: var(--gradient-primary);
      opacity: 0.3;
    }

    .panel-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-green);
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    /* Advanced upload area with drag effects */
    .upload-area {
      border: 2px dashed var(--panel-border);
      border-radius: 16px;
      padding: 40px 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      min-height: 400px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, rgba(0, 255, 136, 0.02), rgba(0, 204, 106, 0.02));
      position: relative;
      overflow: hidden;
    }

    .upload-area::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: conic-gradient(transparent, var(--primary-green), transparent);
      animation: rotate 3s linear infinite;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .upload-area:hover::before {
      opacity: 0.1;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .upload-area.drag-over {
      border-color: var(--primary-green);
      background: rgba(0, 255, 136, 0.1);
      box-shadow: var(--glow);
      transform: scale(1.02);
    }

    .upload-area i {
      font-size: 4rem;
      color: var(--accent-green);
      margin-bottom: 20px;
      transition: all 0.3s ease;
    }

    .upload-area:hover i {
      color: var(--primary-green);
      transform: scale(1.1);
    }

    .upload-text {
      font-size: 1.2rem;
      color: var(--mid-gray);
      margin-bottom: 10px;
    }

    .upload-subtext {
      font-size: 0.9rem;
      color: var(--dark-gray);
    }

    .image-preview {
      max-width: 100%;
      max-height: 350px;
      border-radius: 12px;
      display: none;
      box-shadow: 0 8px 32px rgba(0,0,0,0.5);
      transition: all 0.3s ease;
    }

    .image-preview:hover {
      transform: scale(1.02);
    }

    /* Advanced controls panel */
    .controls-panel {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .control-group {
      background: rgba(255, 255, 255, 0.02);
      padding: 20px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .control-group h3 {
      color: var(--primary-green);
      font-size: 1.1rem;
      margin-bottom: 15px;
      font-weight: 600;
    }

    label {
      color: var(--mid-gray);
      font-weight: 500;
      margin-bottom: 8px;
      display: block;
      font-size: 0.9rem;
    }

    input[type="number"], input[type="range"], select {
      width: 100%;
      padding: 12px 16px;
      border: 1px solid var(--panel-border);
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.05);
      color: var(--light-gray);
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    input[type="number"]:focus, select:focus {
      outline: none;
      border-color: var(--primary-green);
      box-shadow: 0 0 0 3px rgba(0, 255, 136, 0.1);
    }

    input[type="range"] {
      background: transparent;
      -webkit-appearance: none;
      height: 6px;
    }

    input[type="range"]::-webkit-slider-track {
      height: 6px;
      border-radius: 3px;
      background: var(--panel-border);
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: var(--gradient-primary);
      cursor: pointer;
      box-shadow: var(--glow);
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 12px 0;
    }

    .checkbox-wrapper {
      position: relative;
    }

    input[type="checkbox"] {
      width: 20px;
      height: 20px;
      appearance: none;
      border: 2px solid var(--panel-border);
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    input[type="checkbox"]:checked {
      background: var(--gradient-primary);
      border-color: var(--primary-green);
    }

    input[type="checkbox"]:checked::after {
      content: '✓';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: var(--primary-dark);
      font-weight: bold;
      font-size: 12px;
    }

    /* Enhanced buttons */
    .btn {
      padding: 14px 24px;
      width: 100%;
      border-radius: 12px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 12px;
      cursor: pointer;
      color: var(--primary-dark);
      background: var(--gradient-primary);
      box-shadow: var(--glow);
      transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--glow-strong);
    }

    .btn:disabled {
      background: var(--dark-gray);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-secondary {
      background: transparent;
      border: 2px solid var(--panel-border);
      color: var(--mid-gray);
    }

    .btn-secondary:hover {
      border-color: var(--primary-green);
      color: var(--primary-green);
    }

    /* Advanced features */
    .advanced-panel {
      background: linear-gradient(135deg, rgba(0, 255, 136, 0.05), rgba(0, 204, 106, 0.05));
      border: 1px solid var(--primary-green);
      box-shadow: var(--glow);
    }

    .format-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .format-option {
      padding: 12px;
      border: 1px solid var(--panel-border);
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.02);
    }

    .format-option:hover, .format-option.selected {
      border-color: var(--primary-green);
      background: rgba(0, 255, 136, 0.1);
    }

    /* Progress bar */
    .progress-container {
      width: 100%;
      height: 8px;
      background: var(--panel-border);
      border-radius: 4px;
      overflow: hidden;
      margin: 20px 0;
      display: none;
    }

    .progress-bar {
      height: 100%;
      background: var(--gradient-primary);
      width: 0%;
      transition: width 0.3s ease;
      border-radius: 4px;
    }

    /* Batch processing panel */
    .batch-panel {
      grid-column: 1 / -1;
      margin-top: 30px;
    }

    .batch-preview {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
    }

    .batch-item {
      position: relative;
      border-radius: 8px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.05);
      aspect-ratio: 1;
    }

    .batch-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .batch-item .remove-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: rgba(255, 0, 0, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      width: 25px;
      height: 25px;
      cursor: pointer;
      font-size: 12px;
    }

    /* EXIF panel */
    .exif-panel {
      max-height: 400px;
      overflow-y: auto;
    }

    .exif-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.9rem;
    }

    .exif-key {
      color: var(--mid-gray);
      font-weight: 500;
    }

    .exif-value {
      color: var(--light-gray);
    }

    /* Footer */
    .footer {
      text-align: center;
      padding: 40px 20px;
      margin-top: 60px;
      border-top: 1px solid var(--panel-border);
      color: var(--mid-gray);
    }

    .social-icons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 20px;
    }

    .social-icons a {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--panel-bg);
      border: 1px solid var(--panel-border);
      color: var(--mid-gray);
      transition: all 0.3s ease;
      text-decoration: none;
    }

    .social-icons a:hover {
      color: var(--primary-green);
      border-color: var(--primary-green);
      box-shadow: var(--glow);
      transform: translateY(-3px);
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .nav-container {
        flex-direction: column;
        gap: 20px;
      }
      
      .nav-links {
        gap: 20px;
      }
      
      .workspace {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .format-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    /* Loading animations */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid var(--panel-border);
      border-radius: 50%;
      border-top-color: var(--primary-green);
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Notification system */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 24px;
      border-radius: 12px;
      color: white;
      font-weight: 500;
      z-index: 1000;
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }

    .notification.success {
      background: linear-gradient(135deg, #00ff88, #00cc6a);
    }

    .notification.error {
      background: linear-gradient(135deg, #ff4757, #ff3742);
    }

    .notification.show {
      transform: translateX(0);
    }
  </style>
</head>
<body>
  <!-- Background particles -->
  <div class="bg-particles" id="bgParticles"></div>

  <!-- Header -->
  <header class="header">
    <div class="nav-container">
      <div class="logo-section">
        <i class="fas fa-atom logo-icon"></i>
        <div class="logo-text">
          <h1>AniResizer</h1>
          <span class="pro-badge">PRO</span>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <!-- Main workspace -->
    <div class="workspace">
      <!-- Main processing panel -->
      <div class="panel">
        <h2 class="panel-title">
          <i class="fas fa-cloud-upload-alt"></i> 
          AI-Powered Image Processing
        </h2>
        <div class="upload-area" id="dropArea">
          <i class="fas fa-images"></i>
          <div class="upload-text">Drop images here or click to browse</div>
          <div class="upload-subtext">Supports JPG, PNG, WebP, AVIF, HEIC, RAW formats</div>
          <img id="originalPreview" class="image-preview" alt="Preview">
          <input type="file" id="fileInput" class="file-input" accept="image/*" multiple hidden>
        </div>
        <div class="progress-container" id="progressContainer">
          <div class="progress-bar" id="progressBar"></div>
        </div>
      </div>

      <!-- Advanced controls panel -->
      <div class="panel controls-panel">
        <h2 class="panel-title">
          <i class="fas fa-sliders-h"></i> 
          Advanced Controls
        </h2>

        <!-- Basic Controls -->
        <div class="control-group">
          <h3><i class="fas fa-expand-arrows-alt"></i> Dimensions</h3>
          <label for="width">Width (px)</label>
          <input type="number" id="width" placeholder="Auto">
          
          <label for="height">Height (px)</label>
          <input type="number" id="height" placeholder="Auto">
          
          <div class="checkbox-group">
            <input type="checkbox" id="lockRatio" checked>
            <label for="lockRatio">Lock Aspect Ratio</label>
          </div>
        </div>

        <!-- Quality & Compression -->
        <div class="control-group">
          <h3><i class="fas fa-adjust"></i> Quality & Optimization</h3>
          <label for="quality">Quality: <span id="qualityValue">85</span>%</label>
          <input type="range" id="quality" min="10" max="100" value="85">
          
          <label for="compression">Compression Level</label>
          <select id="compression">
            <option value="none">None</option>
            <option value="light">Light</option>
            <option value="medium" selected>Medium</option>
            <option value="aggressive">Aggressive</option>
          </select>
        </div>

        <!-- Format Selection -->
        <div class="control-group">
          <h3><i class="fas fa-file-image"></i> Output Format</h3>
          <div class="format-grid">
            <div class="format-option selected" data-format="jpeg">
              <i class="fas fa-image"></i>
              <div>JPEG</div>
            </div>
            <div class="format-option" data-format="png">
              <i class="fas fa-image"></i>
              <div>PNG</div>
            </div>
            <div class="format-option" data-format="webp">
              <i class="fas fa-image"></i>
              <div>WebP</div>
            </div>
            <div class="format-option" data-format="avif">
              <i class="fas fa-image"></i>
              <div>AVIF</div>
            </div>
          </div>
        </div>

        <!-- Advanced Options -->
        <div class="control-group">
          <h3><i class="fas fa-magic"></i> AI Enhancement</h3>
          <div class="checkbox-group">
            <input type="checkbox" id="aiUpscale">
            <label for="aiUpscale">AI Upscaling</label>
          </div>
          <div class="checkbox-group">
            <input type="checkbox" id="noiseReduction">
            <label for="noiseReduction">Noise Reduction</label>
          </div>
          <div class="checkbox-group">
            <input type="checkbox" id="sharpen">
            <label for="sharpen">Smart Sharpening</label>
          </div>
        </div>

        <!-- Action Buttons -->
        <button class="btn" id="processBtn" disabled>
          <i class="fas fa-magic"></i> Process Image
        </button>
        <button class="btn btn-secondary" id="downloadBtn" disabled>
          <i class="fas fa-download"></i> Download
        </button>
        <button class="btn btn-secondary" id="resetBtn">
          <i class="fas fa-undo"></i> Reset
        </button>
      </div>
    </div>

    <!-- Batch Processing Panel -->
    <div class="panel batch-panel advanced-panel">
      <h2 class="panel-title">
        <i class="fas fa-layer-group"></i> 
        Batch Processing Studio
      </h2>
      <input type="file" id="batchInput" accept="image/*" multiple hidden>
      <button class="btn" id="batchSelectBtn">
        <i class="fas fa-plus"></i> Add Images for Batch Processing
      </button>
      <div class="batch-preview" id="batchPreview"></div>
      <button class="btn" id="batchProcessBtn" disabled>
        <i class="fas fa-cogs"></i> Process All Images
      </button>
    </div>

    <!-- EXIF Data Panel -->
    <div class="panel advanced-panel">
      <h2 class="panel-title">
        <i class="fas fa-info-circle"></i> 
        EXIF Metadata Editor
      </h2>
      <div class="exif-panel" id="exifPanel">
        <p style="color: var(--mid-gray); text-align: center; padding: 40px;">
          Upload an image to view and edit EXIF data
        </p>
      </div>
      <button class="btn btn-secondary" id="removeExifBtn" disabled>
        <i class="fas fa-eraser"></i> Remove All EXIF Data
      </button>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="social-icons">
      <a href="https://github.com/Shineii86" target="_blank" title="GitHub">
        <i class="fab fa-github"></i>
      </a>
      <a href="https://twitter.com/Shineii86" target="_blank" title="Twitter">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://telegram.me/Shineii86" target="_blank" title="Telegram">
        <i class="fab fa-telegram"></i>
      </a>
      <a href="#" title="Discord">
        <i class="fab fa-discord"></i>
      </a>
    </div>
    <p>&copy; 2025 AniResizer Pro. Advanced AI-Powered Image Processing by 
      <a href="https://github.com/Shineii86" style="color:var(--primary-green);text-decoration:none;">Shinei Nouzen</a>
    </p>
  </footer>

  <script>
    // Enhanced JavaScript with advanced features
    class AniResizerPro {
      constructor() {
        this.initElements();
        this.initEventListeners();
        this.initBackgroundParticles();
        this.batchFiles = [];
        this.currentFile = null;
        this.outputFormat = 'jpeg';
        this.aspectRatio = 1;
      }

      initElements() {
        this.dropArea = document.getElementById('dropArea');
        this.fileInput = document.getElementById('fileInput');
        this.batchInput = document.getElementById('batchInput');
        this.preview = document.getElementById('originalPreview');
        this.widthInput = document.getElementById('width');
        this.heightInput = document.getElementById('height');
        this.lockRatio = document.getElementById('lockRatio');
        this.qualitySlider = document.getElementById('quality');
        this.qualityValue = document.getElementById('qualityValue');
        this.compressionSelect = document.getElementById('compression');
        this.processBtn = document.getElementById('processBtn');
        this.downloadBtn = document.getElementById('downloadBtn');
        this.resetBtn = document.getElementById('resetBtn');
        this.batchSelectBtn = document.getElementById('batchSelectBtn');
        this.batchProcessBtn = document.getElementById('batchProcessBtn');
        this.batchPreview = document.getElementById('batchPreview');
        this.exifPanel = document.getElementById('exifPanel');
        this.removeExifBtn = document.getElementById('removeExifBtn');
        this.progressContainer = document.getElementById('progressContainer');
        this.progressBar = document.getElementById('progressBar');
      }

      initEventListeners() {
        // Drop area events
        this.dropArea.addEventListener('click', () => this.fileInput.click());
        this.dropArea.addEventListener('dragover', this.handleDragOver.bind(this));
        this.dropArea.addEventListener('dragleave', this.handleDragLeave.bind(this));
        this.dropArea.addEventListener('drop', this.handleDrop.bind(this));

        // File input
        this.fileInput.addEventListener('change', this.handleFileSelect.bind(this));
        
        // Batch input
        this.batchInput.addEventListener('change', this.handleBatchSelect.bind(this));
        this.batchSelectBtn.addEventListener('click', () => this.batchInput.click());

        // Dimension inputs
        this.widthInput.addEventListener('input', this.handleWidthChange.bind(this));
        this.heightInput.addEventListener('input', this.handleHeightChange.bind(this));

        // Quality slider
        this.qualitySlider.addEventListener('input', () => {
          this.qualityValue.textContent = this.qualitySlider.value;
        });

        // Format selection
        document.querySelectorAll('.format-option').forEach(option => {
          option.addEventListener('click', this.handleFormatSelect.bind(this));
        });

        // Buttons
        this.processBtn.addEventListener('click', this.processImage.bind(this));
        this.downloadBtn.addEventListener('click', this.downloadImage.bind(this));
        this.resetBtn.addEventListener('click', this.reset.bind(this));
        this.batchProcessBtn.addEventListener('click', this.processBatch.bind(this));
        this.removeExifBtn.addEventListener('click', this.removeExifData.bind(this));
      }

      initBackgroundParticles() {
        const particlesContainer = document.getElementById('bgParticles');
        const particleCount = 50;

        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          particle.style.left = Math.random() * 100 + '%';
          particle.style.animationDelay = Math.random() * 8 + 's';
          particle.style.animationDuration = (Math.random() * 3 + 5) + 's';
          particlesContainer.appendChild(particle);
        }
      }

      handleDragOver(e) {
        e.preventDefault();
        this.dropArea.classList.add('drag-over');
      }

      handleDragLeave(e) {
        e.preventDefault();
        this.dropArea.classList.remove('drag-over');
      }

      handleDrop(e) {
        e.preventDefault();
        this.dropArea.classList.remove('drag-over');
        const files = Array.from(e.dataTransfer.files);
        if (files.length === 1) {
          this.handleFile(files[0]);
        } else if (files.length > 1) {
          this.handleBatchFiles(files);
        }
      }

      handleFileSelect(e) {
        const file = e.target.files[0];
        if (file) this.handleFile(file);
      }

      handleBatchSelect(e) {
        const files = Array.from(e.target.files);
        this.handleBatchFiles(files);
      }

      handleFile(file) {
        if (!file.type.startsWith('image/')) {
          this.showNotification('Please select a valid image file', 'error');
          return;
        }

        this.currentFile = file;
        const reader = new FileReader();
        reader.onload = (e) => {
          this.preview.src = e.target.result;
          this.preview.style.display = 'block';
          
          const img = new Image();
          img.onload = () => {
            this.widthInput.value = img.width;
            this.heightInput.value = img.height;
            this.aspectRatio = img.width / img.height;
            this.processBtn.disabled = false;
            this.extractExifData(file);
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(file);
      }

      handleBatchFiles(files) {
        const imageFiles = files.filter(file => file.type.startsWith('image/'));
        this.batchFiles = [...this.batchFiles, ...imageFiles];
        this.updateBatchPreview();
        this.batchProcessBtn.disabled = this.batchFiles.length === 0;
      }

      updateBatchPreview() {
        this.batchPreview.innerHTML = '';
        this.batchFiles.forEach((file, index) => {
          const item = document.createElement('div');
          item.className = 'batch-item';
          
          const img = document.createElement('img');
          img.src = URL.createObjectURL(file);
          
          const removeBtn = document.createElement('button');
          removeBtn.className = 'remove-btn';
          removeBtn.innerHTML = '×';
          removeBtn.onclick = () => this.removeBatchItem(index);
          
          item.appendChild(img);
          item.appendChild(removeBtn);
          this.batchPreview.appendChild(item);
        });
      }

      removeBatchItem(index) {
        this.batchFiles.splice(index, 1);
        this.updateBatchPreview();
        this.batchProcessBtn.disabled = this.batchFiles.length === 0;
      }

      handleFormatSelect(e) {
        document.querySelectorAll('.format-option').forEach(opt => opt.classList.remove('selected'));
        e.currentTarget.classList.add('selected');
        this.outputFormat = e.currentTarget.dataset.format;
      }

      handleWidthChange() {
        if (this.lockRatio.checked && this.widthInput.value) {
          this.heightInput.value = Math.round(this.widthInput.value / this.aspectRatio);
        }
      }

      handleHeightChange() {
        if (this.lockRatio.checked && this.heightInput.value) {
          this.widthInput.value = Math.round(this.heightInput.value * this.aspectRatio);
        }
      }

      async processImage() {
        if (!this.currentFile) return;

        this.showProgress(true);
        this.processBtn.disabled = true;

        try {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          const img = new Image();

          img.onload = () => {
            const width = parseInt(this.widthInput.value) || img.width;
            const height = parseInt(this.heightInput.value) || img.height;

            canvas.width = width;
            canvas.height = height;

            // Apply AI enhancements (simulated)
            if (document.getElementById('noiseReduction').checked) {
              ctx.filter = 'blur(0.5px)';
            }
            if (document.getElementById('sharpen').checked) {
              ctx.filter += ' contrast(110%) brightness(105%)';
            }

            ctx.drawImage(img, 0, 0, width, height);

            const quality = this.qualitySlider.value / 100;
            const mimeType = this.getMimeType(this.outputFormat);

            canvas.toBlob((blob) => {
              this.processedBlob = blob;
              this.downloadBtn.disabled = false;
              this.showProgress(false);
              this.processBtn.disabled = false;
              this.showNotification('Image processed successfully!', 'success');
            }, mimeType, quality);
          };

          img.src = URL.createObjectURL(this.currentFile);
        } catch (error) {
          this.showProgress(false);
          this.processBtn.disabled = false;
          this.showNotification('Error processing image: ' + error.message, 'error');
        }
      }

      async processBatch() {
        if (this.batchFiles.length === 0) return;

        this.showProgress(true);
        this.batchProcessBtn.disabled = true;
        const zip = new JSZip(); // Would need to include JSZip library

        for (let i = 0; i < this.batchFiles.length; i++) {
          const file = this.batchFiles[i];
          this.updateProgress((i / this.batchFiles.length) * 100);
          
          // Process each file (simplified)
          const processedBlob = await this.processFileAsync(file);
          const fileName = `processed_${file.name}`;
          zip.file(fileName, processedBlob);
        }

        // Generate and download zip
        const zipBlob = await zip.generateAsync({type: 'blob'});
        this.downloadZip(zipBlob, 'processed_images.zip');
        
        this.showProgress(false);
        this.batchProcessBtn.disabled = false;
        this.showNotification('Batch processing completed!', 'success');
      }

      async processFileAsync(file) {
        return new Promise((resolve) => {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          const img = new Image();

          img.onload = () => {
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);
            
            canvas.toBlob(resolve, this.getMimeType(this.outputFormat), this.qualitySlider.value / 100);
          };

          img.src = URL.createObjectURL(file);
        });
      }

      extractExifData(file) {
        // Simulated EXIF extraction (would use actual EXIF library)
        const mockExifData = {
          'File Name': file.name,
          'File Size': this.formatFileSize(file.size),
          'File Type': file.type,
          'Last Modified': new Date(file.lastModified).toLocaleString(),
          'Dimensions': 'Loading...',
          'Camera Make': 'Canon',
          'Camera Model': 'EOS R5',
          'ISO': '400',
          'Aperture': 'f/2.8',
          'Shutter Speed': '1/125s',
          'Focal Length': '85mm'
        };

        this.displayExifData(mockExifData);
        this.removeExifBtn.disabled = false;
      }

      displayExifData(exifData) {
        this.exifPanel.innerHTML = '';
        Object.entries(exifData).forEach(([key, value]) => {
          const item = document.createElement('div');
          item.className = 'exif-item';
          item.innerHTML = `
            <span class="exif-key">${key}:</span>
            <span class="exif-value">${value}</span>
          `;
          this.exifPanel.appendChild(item);
        });
      }

      removeExifData() {
        if (!this.currentFile) return;
        
        // Simulate EXIF removal
        this.showNotification('EXIF data removed successfully!', 'success');
        this.displayExifData({
          'File Name': this.currentFile.name,
          'File Size': this.formatFileSize(this.currentFile.size),
          'Status': 'EXIF data removed'
        });
      }

      downloadImage() {
        if (!this.processedBlob) return;

        const url = URL.createObjectURL(this.processedBlob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `processed_${Date.now()}.${this.outputFormat}`;
        a.click();
        URL.revokeObjectURL(url);
        
        this.showNotification('Download started!', 'success');
      }

      downloadZip(blob, filename) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        a.click();
        URL.revokeObjectURL(url);
      }

      reset() {
        this.currentFile = null;
        this.processedBlob = null;
        this.preview.style.display = 'none';
        this.fileInput.value = '';
        this.widthInput.value = '';
        this.heightInput.value = '';
        this.qualitySlider.value = 85;
        this.qualityValue.textContent = '85';
        this.lockRatio.checked = true;
        this.processBtn.disabled = true;
        this.downloadBtn.disabled = true;
        this.removeExifBtn.disabled = true;
        this.exifPanel.innerHTML = '<p style="color: var(--mid-gray); text-align: center; padding: 40px;">Upload an image to view and edit EXIF data</p>';
        this.showNotification('Reset completed!', 'success');
      }

      getMimeType(format) {
        const types = {
          'jpeg': 'image/jpeg',
          'png': 'image/png',
          'webp': 'image/webp',
          'avif': 'image/avif'
        };
        return types[format] || 'image/jpeg';
      }

      formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
      }

      showProgress(show) {
        this.progressContainer.style.display = show ? 'block' : 'none';
        if (!show) this.progressBar.style.width = '0%';
      }

      updateProgress(percent) {
        this.progressBar.style.width = percent + '%';
      }

      showNotification(message, type = 'success') {
        const notification = document.createElement('div');
        notification.className = `notification ${type}`;
        notification.textContent = message;
        document.body.appendChild(notification);

        setTimeout(() => notification.classList.add('show'), 100);
        setTimeout(() => {
          notification.classList.remove('show');
          setTimeout(() => document.body.removeChild(notification), 300);
        }, 3000);
      }
    }

    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      new AniResizerPro();
    });
  </script>
</body>
</html>